--TRIGGER

CREATE OR REPLACE TRIGGER CHECK_CVR
BEFORE UPDATE ON POLICY
FOR EACH ROW
DECLARE
PRC POLICY.P_NO%TYPE;
CVR POLICY.COVERAGE%TYPE;

BEGIN

CVR:= :NEW.COVERAGE;
PRC:= :OLD.PRICE;
IF PRC = CVR THEN
DBMS_OUTPUT.PUT_LINE('EQUAL');
END IF;
END;
/

BEGIN
MATCH_PRICE(5372);
END;
/
SELECT *FROM POLICY;

INSERT INTO POLICY VALUES(34,1000,500,500);
BEGIN
MATCH_PRICE(34);
END;
/


--DATE

select sysdate from dual;

select current_date from dual;

select systimestamp from dual;

--extract

select POL_NO,extract(MONTH from ISSUE_DATE) as months from AUTO_POLICY;

--extract continues

select POL_NO,extract(year from ISSUE_DATE) as year from HOME_POLICY;


--TRANSACTION

INSERT INTO POLICY VALUES (5972,73000,9615,280);

SAVEPOINT T1;

INSERT INTO POLICY VALUES (6528,82000,3565,320);

SAVEPOINT T2;

SELECT * FROM POLICY;

ROLLBACK TO SAVEPOINT T1;

DELETE FROM POLICY WHERE P_NO =6528;

COMMIT;

SELECT * FROM POLICY;

ROLLBACK TO SAVEPOINT T2;

INSERT INTO POLICY VALUES (5242,20000,4765,420);

ROLLBACK;
